---
title: "Rev_exp"
author: "Bernadette Stadler"
date: "11/20/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
    rev <- rev_exp %>%
      select(fiscal_year, womens_revenue, mens_revenue) %>%
      pivot_longer(
        cols = ends_with("revenue"),
        names_to = "Team",
        values_to = "Revenue"
      ) %>%
      mutate(fiscal_year = if_else(
        fiscal_year == "2019 (projected)", 2019, as.double(fiscal_year)
      )) %>%
      mutate(Team = if_else(Team == "womens_revenue", "USWNT", "USMNT"))

    exp <- rev_exp %>%
      select(fiscal_year, womens_expenses, mens_expenses) %>%
      pivot_longer(
        cols = ends_with("expenses"),
        names_to = "Team",
        values_to = "Expenses"
      ) %>%
      mutate(fiscal_year = if_else(
        fiscal_year == "2019 (projected)", 2019, as.double(fiscal_year)
      )) %>%
      mutate(Team = if_else(Team == "womens_expenses", "USWNT", "USMNT"))

    rev_exp_formatted <- exp %>%
      left_join(rev, by = c("fiscal_year", "Team")) %>%
      mutate(Expenses = if_else(is.na(Expenses), 0, Expenses)) %>%
      mutate(Revenue = if_else(is.na(Revenue), 0, Revenue)) %>%
      mutate(Net = Revenue - Expenses) %>%
      pivot_longer(
        cols = Expenses:Net,
        names_to = "Type",
        values_to = "Amount"
      )

    rev_exp_formatted %>%
      ggplot(aes(x = fiscal_year, y = Amount, fill = Type)) +
      geom_col(position = "dodge") +
      scale_fill_manual(values = c("Expenses" = "red", "Revenue" = "green", "Net" = "black")) +
      facet_wrap(~Team) +
      labs(
        x = "Fiscal Year",
        y = "Amount in U.S. dollars",
        title = "Annual Team Expenses and Revenue",
        caption = "Data from U.S. soccer annual reports"
      ) +
      theme_minimal() +
      theme(
        plot.title = element_text(hjust = 0.5)
      )

```

